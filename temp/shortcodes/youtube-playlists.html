{{- $playlists := site.Data.youtube.playlists | default slice -}}
{{- $columns := .Get "columns" | default "2" -}}

<div class="youtube-playlists" data-columns="{{ $columns }}">
  {{- range $playlists -}}
    {{- $playlistData := index site.Data.youtube.all_videos .id -}}
    {{- $videoCount := 0 -}}
    {{- if $playlistData -}}
      {{- $videoCount = len $playlistData.videos -}}
    {{- end -}}
    
    <div class="playlist-card">
      <div class="playlist-thumbnail">
        <img src="{{ if .snippet.thumbnails.maxres }}{{ .snippet.thumbnails.maxres.url }}{{ else }}{{ .snippet.thumbnails.high.url }}{{ end }}" 
             alt="{{ .snippet.title }}" 
             loading="lazy">
        <div class="playlist-overlay">
          <div class="playlist-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/>
            </svg>
          </div>
          <div class="video-count">{{ $videoCount }} видео</div>
        </div>
      </div>
      
      <div class="playlist-content">
        <h3 class="playlist-title">
          <a href="/{{ site.Language.Lang }}/youtube/{{ .id | urlize }}/">
            {{ .snippet.title }}
          </a>
        </h3>
        
        <div class="playlist-meta">
          <span class="updated">{{ dateFormat "2 Jan 2006" .snippet.publishedAt }}</span>
          <span class="video-count">{{ $videoCount }} видео</span>
        </div>
        
        {{- if .snippet.description -}}
          <p class="playlist-description">{{ .snippet.description | truncate 100 }}</p>
        {{- end -}}
        
        <div class="playlist-actions">
          <a href="#playlist-{{ .id }}" class="btn-playlist" data-playlist="{{ .id }}">
            Смотреть плейлист
          </a>
          <a href="https://www.youtube.com/playlist?list={{ .id }}" target="_blank" rel="noopener" class="btn-youtube">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
            YouTube
          </a>
        </div>
      </div>
    </div>
  {{- end -}}
</div>

<style>
.youtube-playlists {
  display: grid;
  gap: 24px;
  margin: 32px 0;
}

.youtube-playlists[data-columns="1"] { grid-template-columns: 1fr; }
.youtube-playlists[data-columns="2"] { grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); }
.youtube-playlists[data-columns="3"] { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }

.playlist-card {
  background: var(--entry);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  border: 1px solid var(--border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.playlist-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 32px rgba(102, 126, 234, 0.15);
  border-color: var(--secondary);
}

.playlist-thumbnail {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  overflow: hidden;
  background: #000;
}

.playlist-thumbnail img {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.playlist-card:hover .playlist-thumbnail img {
  transform: scale(1.05);
}

.playlist-overlay {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 80px;
  background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.8));
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
}

.playlist-icon {
  margin-bottom: 4px;
  opacity: 0.9;
}

.video-count {
  font-size: 0.75rem;
  font-weight: 600;
  text-align: center;
  line-height: 1.2;
}

.playlist-content {
  padding: 16px;
}

.playlist-title {
  margin: 0 0 8px 0;
  font-size: 1.1rem;
  font-weight: 600;
  line-height: 1.3;
}

.playlist-title a {
  color: var(--primary);
  text-decoration: none;
  transition: color 0.3s ease;
}

.playlist-title a:hover {
  color: var(--secondary);
}

.playlist-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 0.85rem;
  color: var(--secondary);
}

.playlist-description {
  margin: 0 0 16px 0;
  color: var(--secondary);
  font-size: 0.9rem;
  line-height: 1.4;
}

.playlist-actions {
  display: flex;
  gap: 12px;
  align-items: center;
}

.btn-playlist {
  flex: 1;
  display: inline-block;
  padding: 8px 16px;
  background: linear-gradient(45deg, #667eea, #764ba2);
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-weight: 500;
  text-align: center;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.btn-playlist:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-youtube {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: #ff0000;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-weight: 500;
  transition: all 0.3s ease;
  font-size: 0.85rem;
}

.btn-youtube:hover {
  background: #d70000;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
}

/* Адаптивность */
@media (max-width: 768px) {
  .youtube-playlists {
    grid-template-columns: 1fr !important;
    gap: 16px;
  }
  
  .playlist-content {
    padding: 12px;
  }
  
  .playlist-actions {
    flex-direction: column;
    gap: 8px;
  }
  
  .btn-playlist,
  .btn-youtube {
    width: 100%;
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .playlist-meta {
    flex-direction: column;
    align-items: flex-start;
    gap: 4px;
  }
  
  .playlist-title {
    font-size: 1rem;
  }
  
  .playlist-overlay {
    width: 60px;
  }
  
  .video-count {
    font-size: 0.7rem;
  }
}

/* Стиль для ссылки на YouTube плейлист */
.btn-youtube-link {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: linear-gradient(45deg, #ff0000, #cc0000);
  color: white;
  text-decoration: none;
  border-radius: 6px;
  font-weight: 500;
  margin: 16px 0;
  transition: all 0.3s ease;
  font-size: 0.9rem;
}

.btn-youtube-link:hover {
  background: linear-gradient(45deg, #d70000, #990000);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
  color: white;
}

.btn-youtube-link::after {
  content: "→";
  font-weight: bold;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Плавная прокрутка к якорям плейлистов
  const playlistButtons = document.querySelectorAll('.btn-playlist[data-playlist]');
  
  playlistButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      const playlistId = this.getAttribute('data-playlist');
      const targetElement = document.getElementById(`playlist-${playlistId}`);
      
      if (targetElement) {
        e.preventDefault();
        targetElement.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
        
        // Подсветка заголовка
        targetElement.style.color = 'var(--secondary)';
        setTimeout(() => {
          targetElement.style.color = '';
        }, 2000);
      }
    });
  });
});
</script> 